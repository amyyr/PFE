<app-banner title="Add Match"></app-banner>
<h1>Score</h1>
<div class="site-section bg-gris">
  <div class="row">
    <div class="col-12">
      <div class="d-flex team-vs">
  
        <div class="team-1 w-50">
          <div class="team-details w-100 text-center">
            <img *ngIf="selectedHomeCountry && !selectedHomeLeague && !selectedHomeTeam" [src]="selectedHomeCountry.country_logo" alt="Country Logo" class="img-fluid">
            <img *ngIf="selectedHomeLeague && !selectedHomeTeam" [src]="selectedHomeLeague.league_logo" alt="League Logo" class="img-fluid">
            <img *ngIf="selectedHomeTeam" [src]="selectedHomeTeam.team_logo" alt="Team Logo" class="img-fluid">

            <h3>
              <ng-container *ngIf="selectedHomeCountry && !selectedHomeLeague && !selectedHomeTeam">
                Country <span>Home</span>
              </ng-container>
              <ng-container *ngIf="selectedHomeLeague && !selectedHomeTeam">
                League <span>Home</span>
              </ng-container>
              <ng-container *ngIf="selectedHomeTeam">
                Team <span>Home</span>
              </ng-container>
            </h3>

            <div class="scrollable-box">
              <mat-accordion>
                <mat-expansion-panel *ngFor="let country of countries" (opened)="onHomeCountryChange(country)">
                  <mat-expansion-panel-header>
                    <mat-panel-title>
                      <img [src]="country.country_logo" alt="{{country.country_name}}" class="img-flag">
                      {{country.country_name}}
                    </mat-panel-title>
                  </mat-expansion-panel-header>

                  <mat-accordion>
                    <mat-expansion-panel *ngFor="let league of homeLeagues" (opened)="onHomeLeagueChange(league)">
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          <img [src]="league.league_logo" alt="{{league.league_name}}" class="img-flag">
                          {{league.league_name}}
                        </mat-panel-title>
                      </mat-expansion-panel-header>

                      <mat-list>
                        <mat-list-item *ngFor="let team of homeTeams" (click)="onHomeTeamChange(team)">
                          <img [src]="team.team_logo" alt="{{team.team_name}}" class="img-flag">
                          {{team.team_name}}
                        </mat-list-item>
                      </mat-list>
                    </mat-expansion-panel>
                  </mat-accordion>
                </mat-expansion-panel>
              </mat-accordion>
            </div>
          </div>
        </div>
        <div class="team-2 w-50">
          <div class="team-details w-100 text-center">
            <img *ngIf="selectedAwayCountry && !selectedAwayLeague && !selectedAwayTeam" [src]="selectedAwayCountry.country_logo" alt="Country Logo" class="img-fluid">
            <img *ngIf="selectedAwayLeague && !selectedAwayTeam" [src]="selectedAwayLeague.league_logo" alt="League Logo" class="img-fluid">
            <img *ngIf="selectedAwayTeam" [src]="selectedAwayTeam.team_logo" alt="Team Logo" class="img-fluid">

            <h3>
              <ng-container *ngIf="selectedAwayCountry && !selectedAwayLeague && !selectedAwayTeam">
                Country <span>Away</span>
              </ng-container>
              <ng-container *ngIf="selectedAwayLeague && !selectedAwayTeam">
                League <span>Away</span>
              </ng-container>
              <ng-container *ngIf="selectedAwayTeam">
                Team <span>Away</span>
              </ng-container>
            </h3>

            <div class="scrollable-box">
              <mat-accordion>
                <mat-expansion-panel *ngFor="let country of countries" (opened)="onAwayCountryChange(country)">
                  <mat-expansion-panel-header>
                    <mat-panel-title>
                      <img [src]="country.country_logo" alt="{{country.country_name}}" class="img-flag">
                      {{country.country_name}}
                    </mat-panel-title>
                  </mat-expansion-panel-header>

                  <mat-accordion>
                    <mat-expansion-panel *ngFor="let league of awayLeagues" (opened)="onAwayLeagueChange(league)">
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          <img [src]="league.league_logo" alt="{{league.league_name}}" class="img-flag">
                          {{league.league_name}}
                        </mat-panel-title>
                      </mat-expansion-panel-header>

                      <mat-list>
                        <mat-list-item *ngFor="let team of awayTeams" (click)="onAwayTeamChange(team)">
                          <img [src]="team.team_logo" alt="{{team.team_name}}" class="img-flag">
                          {{team.team_name}}
                        </mat-list-item>
                      </mat-list>
                    </mat-expansion-panel>
                  </mat-accordion>
                </mat-expansion-panel>
              </mat-accordion>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="container">
  <h2>Télécharger une vidéo</h2>
  <form [formGroup]="videoForm" (ngSubmit)="onUpload()">
    <div class="flex items-center justify-center w-full">
      <label for="dropzone-file" class="flex flex-col items-center justify-center w-full h-64 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600">
        <div class="flex flex-col items-center justify-center pt-5 pb-6">
          <svg class="w-8 h-8 mb-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 16">
            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"/>
          </svg>
          <p class="mb-2 text-sm text-gray-500 dark:text-gray-400">
            <span class="text-center" *ngIf="!selectedFileName">Click to upload</span>
            <span class="font-semibold" *ngIf="selectedFileName">{{ selectedFileName }}</span>
          </p>
          <p class="text-xs text-gray-500 dark:text-gray-400" *ngIf="!selectedFileName">SVG, PNG, JPG or GIF (MAX. 800x400px)</p>
        </div>
        <input id="dropzone-file" type="file" class="hidden" (change)="onFileSelected($event)" accept="video/*" />
      </label>
    </div>
    <br>
    <div class="d-flex justify-content-center">
    
      <button *ngIf="inputIndexesLeft.length === 0" type="button" (click)="addInputsLeft(); removePrecedingPlusLeft()" class="Btn btn-success">
        ADD player
      </button>
      <button type="submit" [disabled]="!fileToUpload" class="Btn btn-success mx-3">Upload</button>
      <div class="text-center">
        <button type="submit" class="Btn btn-success mx-3" (click)="processVideo()">Process Video</button>
          <button type="button" class="Btn btn-success  mx-3" (click)="trackVideo()" [disabled]="!uploadedFilename">Track Video</button>
          <button *ngIf="inputIndexesRight.length === 0" type="button" (click)="addInputsRight(); removePrecedingPlusRight()" class="Btn btn-success mx-3">
            ADD Player
          </button>
      </div>
    </div>
  </form>
</div>



<div *ngIf="processedVideoURL" class="mt-3">
  <h2>Processed Video</h2>
  <video controls [src]="processedVideoURL" type="video/mp4">
    Your browser does not support the video tag.
  </video>
</div>

<div class="container mb-5">
  <div class="row">
    <div class="col-md-6">
      <div class="d-flex align-items-center mb-2">
       
      </div>
      <div class="container">
        <div class="row" *ngFor="let index of inputIndexesLeft; let i = index">
          <div class="col-md-12 d-flex align-items-center mb-2">
            <div class="form-group mr-2">
              <label for="input{{ index }}_1">Track_id:</label>
              <input type="text" class="form-control" id="input{{ index }}_1" placeholder="Enter your ID">
            </div>
            <div *ngIf="homePlayers.length > 0" class="form-group mr-2">
              <label for="player{{ index }}">Players:</label>
              <select id="player{{ index }}" class="form-control">
                <option value="" selected>Select Player</option>
                <option *ngFor="let player of homePlayers" [value]="player.player_key">
                  {{ player.player_name }} ({{ player.player_type }})
                </option>
              </select>
            </div>
            <button *ngIf="i === inputIndexesLeft.length - 1" type="button" (click)="addInputsLeft(); removePrecedingPlusLeft()" class="Btn btn-success">
              +
            </button>
            <button type="button" (click)="removeInputLeft(i)" class="Btn btn-danger" style="margin-left: 5px;">
              -
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <div class="d-flex align-items-center mb-2">
     
      </div>
      <div class="container">
        <div class="row" *ngFor="let index of inputIndexesRight; let i = index">
          <div class="col-md-12 d-flex align-items-center mb-2">
            <div class="form-group mr-2">
              <label for="input{{ index }}_1">Track_id:</label>
              <input type="text" class="form-control" id="input{{ index }}_1" placeholder="Enter your ID">
            </div>
            <div *ngIf="awayPlayers.length > 0" class="form-group mr-2">
              <label for="player{{ index }}">Players:</label>
              <select id="player{{ index }}" class="form-control">
                <option value="" selected>Select Player</option>
                <option *ngFor="let player of awayPlayers" [value]="player.player_key">
                  {{ player.player_name }} ({{ player.player_type }})
                </option>
              </select>
            </div>
            <button *ngIf="i === inputIndexesRight.length - 1" type="button" (click)="addInputsRight(); removePrecedingPlusRight()" class="Btn btn-success">
              +
            </button>
            <button type="button" (click)="removeInputRight(i)" class="Btn btn-danger" style="margin-left: 5px;">
              -
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


